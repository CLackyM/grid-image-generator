<!DOCTYPE html>
<html>
<head>
	<title>Grid image generator</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="keywords" content="bootstrap, generator, photoshop, grid, image, gutter, col, row, column" />
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!--[if lt IE 9]><script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script><script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
	<style>
		.col-highlight {
			background:rgba(255, 0, 0, 0.40);
			min-height:40px;
		}
		.pre-result-wrapper {
			overflow-x:scroll;
			max-height:500px;
			max-width:100vw;
			outline:dotted 1px gray;
			padding-top:5px;
		}
		.pre-result-container {
			position:relative;
			min-height:40px;
		}
		.pre-result-container [class*="col-"] {
			background:rgba(255, 0, 0, 0.20);
			position: relative;
		}
		.pre-result-row {
			margin-bottom:5px;
			position:relative;
		}
		.edit-row {
			position:absolute;
			opacity:0;
			right:1px;
			top:1px;
			z-index:1;
			background:#fff;
			padding:2px 4px;
			max-width: 300px;
		}
		.pre-result-row:hover .edit-row {
			opacity:1;
		}
	</style>
</head>
<body>
	<section>
		<div class="container">
			<div class="row">
				<div class="col-12">
					<h1>Grid image generator for 12 columns grid</h1>
					<div class="card mb-3">
						<div class="card-body">
							<h4 class="card-title">Configure rows with columns</h4>
							<div class="row">
								<div class="col-12 col-md-7 mb-2">
									<h5>Presets</h5>
									<div class="_presets-cols-container">
										<div class="row mb-2">
											<div class="col-12">
												<button class="btn btn-outline-secondary">1-1-1-1-1-1-1-1-1-1-1-1</button> <button class="btn btn-outline-secondary">2-2-2-2-2-2</button> <button class="btn btn-outline-secondary">3-3-3-3</button> <button class="btn btn-outline-secondary">4-4-4</button>
											</div>
										</div>
										<div class="row">
											<div class="col-12">
												<button class="btn btn-outline-secondary">12</button> <button class="btn btn-outline-secondary">11-1</button> <button class="btn btn-outline-secondary">10-2</button> <button class="btn btn-outline-secondary">9-3</button> <button class="btn btn-outline-secondary">8-4</button> <button class="btn btn-outline-secondary">7-5</button> <button class="btn btn-outline-secondary">6-6</button> <button class="btn btn-outline-secondary">5-7</button> <button class="btn btn-outline-secondary">4-8</button> <button class="btn btn-outline-secondary">3-9</button> <button class="btn btn-outline-secondary">2-10</button> <button class="btn btn-outline-secondary">1-11</button>
											</div>
										</div>
									</div>
								</div>
								<div class="col-12 col-md-5">
									<h5>Manual</h5>
									Enter max 1-1-1-1-1-1-1-1-1-1-1-1 and min 12 and summ of columns must be 12. <span class="text-muted">for example 2-8-2 or 3-4-5</span>
									<div class="input-group mb-3">
										<input class="form-control _manual-cols-input" type="text" name="name" value="" />
										<a class="btn btn-outline-secondary _add-manual-cols" href="#">Add row</a>
									</div>
									<div class="_warn text-danger"></div>
								</div>
							</div>
						</div>
					</div>
					
					<div class="row mb-3">
						<div class="col-12 col-md-6 mb-2">
							<div class="card">
								<div class="card-body">
									<h4 class="card-title">Set width</h4>
									<div class="row">
										<div class="col-12 col-xl-7 mb-2">
											<h5>Presets</h5>
											<div class="_presets-width-container">
												<div class="row">
													<div class="col-12">
														<div class="btn-group" role="group">
															<input type="radio" class="btn-check" name="btnwidth" value="540" id="width0" autocomplete="off">
															<label class="btn btn-outline-secondary" for="width0">540</label>
														
															<input type="radio" class="btn-check" name="btnwidth" value="720" id="width1" autocomplete="off">
															<label class="btn btn-outline-secondary" for="width1">720</label>
														
															<input type="radio" class="btn-check" name="btnwidth" value="960" id="width2" autocomplete="off">
															<label class="btn btn-outline-secondary" for="width2">960</label>
					
															<input type="radio" class="btn-check" name="btnwidth" value="1140" id="width3" autocomplete="off">
															<label class="btn btn-outline-secondary" for="width3">1140</label>
														
															<input type="radio" class="btn-check" name="btnwidth" value="1320" id="width4" autocomplete="off">
															<label class="btn btn-outline-secondary" for="width4">1320</label>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="col-12 col-xl-5">
											<h5>Manual, <small>max 1320 px</small></h5>
											<input class="form-control _set-width-input" type="number" name="name" value="" max="1320" />
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-12 col-md-6">
							<div class="card">
								<div class="card-body">
									<h4 class="card-title">Set gutter</h4>
									<div class="row">
										<div class="col-12 col-xl-7 mb-2">
											<h5>Presets</h5>
											<div class="btn-group _presets-gutter-container" role="group">
												<input type="radio" class="btn-check" name="btnradio" value="0" id="gutter0" autocomplete="off">
												<label class="btn btn-outline-secondary" for="gutter0">0</label>
											
												<input type="radio" class="btn-check" name="btnradio" value="0.25" id="gutter1" autocomplete="off">
												<label class="btn btn-outline-secondary" for="gutter1">1</label>
											
												<input type="radio" class="btn-check" name="btnradio" value="0.5" id="gutter2" autocomplete="off">
												<label class="btn btn-outline-secondary" for="gutter2">2</label>
		
												<input type="radio" class="btn-check" name="btnradio" value="1" id="gutter3" autocomplete="off">
												<label class="btn btn-outline-secondary" for="gutter3">3</label>
											
												<input type="radio" class="btn-check" name="btnradio" value="1.5" id="gutter4" autocomplete="off" checked>
												<label class="btn btn-outline-secondary" for="gutter4">4</label>
											
												<input type="radio" class="btn-check" name="btnradio" value="3" id="gutter5" autocomplete="off">
												<label class="btn btn-outline-secondary" for="gutter5">5</label>
											</div>
										</div>
										<div class="col-12 col-xl-5">
											<h5>Manual, <small>px</small></h5>
											<input class="form-control _manual-gutter-input" type="number" name="name" value="36" />
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					
					
				</div>
			</div>
		</div>
		<div class="container">
			<div class="row">
				<div class="col-12"><h2>Pre-result <button class="btn btn-sm btn-outline-secondary _generate" disabled>Generate</button></h2></div>
			</div>
		</div>
		<div class="pre-result-wrapper"><div class="container _pre-result-container pre-result-container"></div></div>
		<br />
		<div class="container">
			<div class="row">
				<div class="col-12">
					<h3>Result <a download="" href="" class="btn btn-sm btn-outline-secondary disabled _download">Download</a></h3>
				</div>
			</div>
		</div>
		<div class="container-fluid" id="result">
			<img src="" class="img-responsive d-block mx-auto _result-image" alt="Here will be a picture" />
		</div>

	</section>

	<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
	<script src="https://code.jquery.com/jquery-migrate-3.0.0.min.js" integrity="sha256-JklDYODbg0X+8sPiKkcFURb5z7RvlNMIaE3RA2z97vw=" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
	<script>
		$(function () {
			"use strict";

			var colsConf = '',
				setWidthInput = $('._set-width-input'),
				setGutterInput = $('._set-gutter-input'),
				resultImage = $('._result-image'),
				downloadButton = $('._download'),
				presetsColsContainer = $('._presets-cols-container'),
				presetsWidthContainer = $('._presets-width-container'),
				presetsGutterContainer = $('._presets-gutter-container'),
				manualGutterInput = $('._manual-gutter-input'),
				manualColsInput = $('._manual-cols-input'),
				addManualCols = $('._add-manual-cols'),
				preResult = $('._pre-result-container'),
				generateButton = $('._generate'),
				warn = $('._warn'),
				canvas = document.createElement("canvas"),
				canvasContext = canvas.getContext("2d"),
				width = 970,
				gutter = 30;
			var editRowTemplate = '<div class="input-group input-group-sm _edit-row edit-row">		<span class="input-group-text">Set row height</span>		<input type="number" class="form-control" value="40">		<span class="input-group-text">OR</span>		<button type="submit" class="btn btn-outline-secondary btn-sm _delete-row">Delete row</button>	</div>'

			function parseColsValue(val) {
				var arr = val.split('-');
				return validateColsValue(arr) === 12 ? arr : false;
			}
			function validateColsValue(arr) {
				for (var i = 0, sum = 0; i < arr.length; sum += Number(arr[i++]));
				return sum===12?sum:false;
			}
			function addRow(colsVal) {
				warn.html('');
				var colsArr = parseColsValue(colsVal);
				if (colsArr === false) {
					warn.html('invalid format or sum not 12!')
				} else {
					createRow(colsArr);
				}
				generateButton.prop('disabled', generateButtonEnabler());
			}
			function createRow(colsArr) {
				var row = $('<div class="row _pre-result-row pre-result-row"/>');
				var cols = [];
				row.append(editRowTemplate);
				preResult.append(row);
				for (var i = 0; i < colsArr.length; i++) {
					cols.push($('<div class="_pre-result-col col-' + colsArr[i] + '"/>').append('<div class="col-highlight"/>'))

				}
				row.append(cols);
				row.find('._delete-row').click(function () {
					$(this).closest('._pre-result-row').remove();
				})
				row.find('._edit-row input').change(function () {
					setRowHeight($(this).closest('._pre-result-row'), $(this).val());

				})
				/*row.find('._set-row-height').click(function () {
					setRowHeight($(this).closest('._pre-result-row'), $(this).prev().find('input').val());
				})*/
			}
			function setRowHeight(row, height) {
				row.find('.col-highlight').height(height);
			};
			function generateButtonEnabler() {
				return preResult.html() === '' ? true : false;
			}
			function generateImage() {
				var imgData;
				var rows = preResult.find('._pre-result-row');
				canvas.width = preResult.outerWidth();
				canvas.height = preResult.height();

				canvasContext.fillStyle = "rgba(255, 255, 255, 0)";
				canvasContext.fillRect(0, 0, canvas.width, canvas.height);


				for (var i = 0; i < rows.length; i++) {
					var $row = $(rows[i]);
					var rowHeight = $row.height();
					var rowPosition = $row.position();
					var cols = $row.find('._pre-result-col');
					for (var q = 0; q < cols.length; q++) {
						var $col = $(cols[q]);
						var colWidth = $col.outerWidth(true);
						var colPosition = $col.position();
						var $colHighlight = $($col.find('.col-highlight')[0]);
						var colHighlightWidth = $colHighlight.outerWidth(true);
						var colHighlightPosition = $colHighlight.position();
						canvasContext.fillStyle = "rgba(255, 0, 0, 0.2)";
						canvasContext.fillRect(colPosition.left, rowPosition.top, colWidth, rowHeight);
						canvasContext.fillStyle = "rgba(255, 0, 0, 0.4)";
						canvasContext.fillRect(colPosition.left+colHighlightPosition.left, rowPosition.top, colHighlightWidth, rowHeight);
					}
				}

				imgData = canvas.toDataURL();
				resultImage.attr('src' , imgData);
				downloadButton.attr({
					'download': 'grid-image-width-'+width+'.png',
					'href': imgData
				});
				downloadButton.removeClass('disabled');
			};
			function setPreResultContainerWidth(val) {
				if(val) width = val;
				preResult.width(width);
			}
			function setPreResultGutter(val, index) {
				gutter = convertRemToPixels(val * 1.5);
				manualGutterInput.val(gutter);
				$('._pre-result-row').each(function() {
					$(this).removeClass('gx-0 gx-1 gx-2 gx-3 gx-4 gx-5');
					$(this)[0].style.removeProperty('--bs-gutter-x');
					$(this).addClass('gx-'+index);
				});
				setPreResultContainerWidth();
				function convertRemToPixels(rem) {
					return rem * parseFloat(getComputedStyle(document.documentElement).fontSize);
				}
			}
			
			setWidthInput.change(function () {
				setPreResultContainerWidth(this.value);
			});
			addManualCols.click(function (e) {
				e.preventDefault();
				addRow(manualColsInput.val());
			});
			presetsColsContainer.find('button').each(function () {
				$(this).click(function () {
					addRow($(this).html());
				})
			})
			/*presetsWidthContainer.find('button').each(function () {
				$(this).click(function () {
					setPreResultContainerWidth(Number($(this).html()));
				})
			})*/
			presetsWidthContainer.find('input').each(function () {
				$(this).change(function () {
					setPreResultContainerWidth(Number($(this).val()));
				})
			})
			presetsGutterContainer.find('input').each(function() {
				$(this).change(function(){
					setPreResultGutter(Number($(this).val()), $(this).index() / 2);
				})
			})
			manualGutterInput.change(function() {
				
				gutter = $(this).val();
				setPreResultContainerWidth();
				$('._pre-result-row').each(function() {
					$(this).removeClass('gx-0 gx-1 gx-2 gx-3 gx-4 gx-5');
					$(this)[0].style.setProperty('--bs-gutter-x', gutter+"px");
				});
			})
			generateButton.click(function () {
				generateImage();
				var scrollDiv = document.getElementById("result").offsetTop;
				window.scrollTo({ top: scrollDiv-100, behavior: 'smooth'});
			})
		});
	</script>
	<!-- Yandex.Metrika counter -->
	<script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function () { try { w.yaCounter44934619 = new Ya.Metrika({ id: 44934619, clickmap: true, trackLinks: true, accurateTrackBounce: true, webvisor: true }); } catch (e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks"); </script> <noscript><div><img src="https://mc.yandex.ru/watch/44934619" style="position:absolute; left:-9999px;" alt="" /></div></noscript> <!-- /Yandex.Metrika counter -->
	<script>
		(function (i, s, o, g, r, a, m) {
		i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
			(i[r].q = i[r].q || []).push(arguments)
		}, i[r].l = 1 * new Date(); a = s.createElement(o),
			m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
		})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

		ga('create', 'UA-100773132-1', 'auto');
		ga('send', 'pageview');

	</script>
</body>
</html>